<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¾å®¢å¤šAIé€‰å“åŠ©æ‰‹ | Mercado Libre Product Picker</title>
  <meta name="description" content="AIé©±åŠ¨çš„ç¾å®¢å¤šé€‰å“å·¥å…·ï¼Œä¸€é”®åˆ†æå¸‚åœºç«äº‰ã€å‘ç°è“æµ·æœºä¼šã€åŒ¹é…1688è´§æº">
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ›’</text></svg>">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            meli: {
              yellow: '#FFE600',
              blue: '#3483FA',
              dark: '#1A1A1A',
            }
          }
        }
      }
    }
  </script>

  <!-- Vue 3 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

  <style>
    [v-cloak] { display: none; }
    .gradient-bg {
      background: linear-gradient(135deg, #1A1A1A 0%, #2D2D2D 100%);
    }
    .card-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(255, 230, 0, 0.1);
    }
    .score-bar {
      transition: width 0.5s ease-out;
    }
    @keyframes pulse-yellow {
      0%, 100% { box-shadow: 0 0 0 0 rgba(255, 230, 0, 0.4); }
      50% { box-shadow: 0 0 0 10px rgba(255, 230, 0, 0); }
    }
    .pulse-yellow { animation: pulse-yellow 2s infinite; }
  </style>
</head>
<body class="gradient-bg min-h-screen text-white">
  <div id="app" v-cloak>
    <!-- Header -->
    <header class="border-b border-gray-800">
      <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <span class="text-3xl">ğŸ›’</span>
          <div>
            <h1 class="text-xl font-bold text-meli-yellow">ç¾å®¢å¤šAIé€‰å“åŠ©æ‰‹</h1>
            <p class="text-xs text-gray-400">Mercado Libre Product Picker</p>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <select v-model="site" class="bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm">
            <option value="MLM">ğŸ‡²ğŸ‡½ å¢¨è¥¿å“¥</option>
            <option value="MLB">ğŸ‡§ğŸ‡· å·´è¥¿</option>
            <option value="MLA">ğŸ‡¦ğŸ‡· é˜¿æ ¹å»·</option>
            <option value="MLC">ğŸ‡¨ğŸ‡± æ™ºåˆ©</option>
            <option value="MCO">ğŸ‡¨ğŸ‡´ å“¥ä¼¦æ¯”äºš</option>
          </select>
          <span class="text-sm text-gray-400">å‰©ä½™ <span class="text-meli-yellow font-bold">{{ freeQuota }}</span> æ¬¡</span>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 py-8">
      <!-- Search Box -->
      <div class="bg-gray-900 rounded-2xl p-6 mb-8 border border-gray-800">
        <div class="flex gap-4">
          <div class="flex-1 relative">
            <input
              v-model="keyword"
              @keyup.enter="analyze"
              type="text"
              placeholder="è¾“å…¥å•†å“å…³é”®è¯ï¼Œå¦‚ phone case, bluetooth earbuds..."
              class="w-full bg-gray-800 border border-gray-700 rounded-xl px-5 py-4 text-lg focus:border-meli-yellow focus:outline-none transition"
            >
            <span v-if="keyword" @click="keyword=''" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 cursor-pointer hover:text-white">âœ•</span>
          </div>
          <button
            @click="analyze"
            :disabled="loading || !keyword.trim()"
            class="bg-meli-yellow text-black font-bold px-8 py-4 rounded-xl hover:bg-yellow-400 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center gap-2"
          >
            <span v-if="loading" class="animate-spin">â³</span>
            <span v-else>ğŸ”</span>
            {{ loading ? 'åˆ†æä¸­...' : 'å¼€å§‹åˆ†æ' }}
          </button>
        </div>
        <div class="mt-4 flex gap-2 flex-wrap">
          <span class="text-sm text-gray-500">çƒ­é—¨æœç´¢ï¼š</span>
          <button
            v-for="tag in hotTags"
            :key="tag"
            @click="keyword = tag; analyze()"
            class="text-sm bg-gray-800 hover:bg-gray-700 px-3 py-1 rounded-full transition"
          >
            {{ tag }}
          </button>
        </div>
      </div>

      <!-- Loading State -->
      <div v-if="loading" class="text-center py-20">
        <div class="inline-block w-16 h-16 border-4 border-meli-yellow border-t-transparent rounded-full animate-spin mb-4"></div>
        <p class="text-gray-400">æ­£åœ¨åˆ†æ "{{ keyword }}" çš„å¸‚åœºæ•°æ®...</p>
        <p class="text-sm text-gray-600 mt-2">é¦–æ¬¡æŸ¥è¯¢å¯èƒ½éœ€è¦ 10-15 ç§’</p>
      </div>

      <!-- Results -->
      <div v-else-if="result" class="space-y-6">
        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div class="bg-gray-900 rounded-xl p-5 border border-gray-800 card-hover transition">
            <div class="text-gray-400 text-sm mb-1">å•†å“æ€»æ•°</div>
            <div class="text-2xl font-bold text-white">{{ formatNumber(result.market.total_results) }}</div>
          </div>
          <div class="bg-gray-900 rounded-xl p-5 border border-gray-800 card-hover transition">
            <div class="text-gray-400 text-sm mb-1">ä»·æ ¼åŒºé—´</div>
            <div class="text-2xl font-bold text-white">${{ result.market.price_min }} - ${{ result.market.price_max }}</div>
          </div>
          <div class="bg-gray-900 rounded-xl p-5 border border-gray-800 card-hover transition">
            <div class="text-gray-400 text-sm mb-1">ä¸­ä½ä»·æ ¼</div>
            <div class="text-2xl font-bold text-meli-yellow">${{ result.market.price_median }}</div>
          </div>
          <div class="bg-gray-900 rounded-xl p-5 border border-gray-800 card-hover transition">
            <div class="text-gray-400 text-sm mb-1">AIå»ºè®®</div>
            <div class="text-2xl font-bold" :class="recommendColor">{{ result.analysis.recommendation }}</div>
          </div>
        </div>

        <!-- Competition Score -->
        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-bold">ç«äº‰æ¿€çƒˆåº¦</h3>
            <span class="text-3xl font-bold" :class="scoreColor">{{ result.analysis.competition_score }}/10</span>
          </div>
          <div class="h-4 bg-gray-800 rounded-full overflow-hidden">
            <div
              class="h-full score-bar rounded-full"
              :class="scoreBarColor"
              :style="{ width: result.analysis.competition_score * 10 + '%' }"
            ></div>
          </div>
          <p class="mt-3 text-gray-400">{{ result.analysis.reason }}</p>
        </div>

        <!-- Two Column Layout -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Blue Ocean Niches -->
          <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
            <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
              <span>ğŸŒŠ</span> è“æµ·ç»†åˆ†è¯
            </h3>
            <div class="space-y-3">
              <div
                v-for="(niche, i) in result.analysis.sub_niches"
                :key="i"
                class="flex items-center gap-3 bg-gray-800 rounded-lg px-4 py-3 hover:bg-gray-700 cursor-pointer transition"
                @click="keyword = niche; analyze()"
              >
                <span class="w-6 h-6 bg-meli-blue rounded-full flex items-center justify-center text-sm">{{ i + 1 }}</span>
                <span>{{ niche }}</span>
                <span class="ml-auto text-gray-500">â†’</span>
              </div>
              <div v-if="!result.analysis.sub_niches?.length" class="text-gray-500 text-center py-4">
                æš‚æ— è“æµ·è¯å»ºè®®
              </div>
            </div>
          </div>

          <!-- Differentiation Tips -->
          <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
            <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
              <span>ğŸ’¡</span> å·®å¼‚åŒ–å»ºè®®
            </h3>
            <ul class="space-y-3">
              <li
                v-for="(tip, i) in result.analysis.differentiation_tips"
                :key="i"
                class="flex items-start gap-3"
              >
                <span class="text-meli-yellow">âœ“</span>
                <span class="text-gray-300">{{ tip }}</span>
              </li>
              <li v-if="!result.analysis.differentiation_tips?.length" class="text-gray-500 text-center py-4">
                æš‚æ— å·®å¼‚åŒ–å»ºè®®
              </li>
            </ul>
          </div>
        </div>

        <!-- 1688 Sources (Placeholder) -->
        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
          <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
            <span>ğŸ“¦</span> 1688è´§æºåŒ¹é…
            <span class="text-xs bg-gray-700 px-2 py-1 rounded-full">å³å°†ä¸Šçº¿</span>
          </h3>
          <div class="text-center py-8 text-gray-500">
            <p>ğŸš§ è´§æºåŒ¹é…åŠŸèƒ½å¼€å‘ä¸­...</p>
            <p class="text-sm mt-2">è¾“å…¥å…³é”®è¯åå°†è‡ªåŠ¨åŒ¹é…1688åŒæ¬¾è´§æº</p>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex gap-4 justify-center">
          <button
            @click="favorite"
            class="bg-gray-800 hover:bg-gray-700 px-6 py-3 rounded-xl flex items-center gap-2 transition"
          >
            <span>â­</span> æ”¶è—æ­¤åˆ†æ
          </button>
          <button
            @click="exportResult"
            class="bg-gray-800 hover:bg-gray-700 px-6 py-3 rounded-xl flex items-center gap-2 transition"
          >
            <span>ğŸ“¥</span> å¯¼å‡ºæŠ¥å‘Š
          </button>
          <button
            @click="result = null; keyword = ''"
            class="bg-meli-blue hover:bg-blue-600 px-6 py-3 rounded-xl flex items-center gap-2 transition"
          >
            <span>ğŸ”„</span> æ–°çš„åˆ†æ
          </button>
        </div>
      </div>

      <!-- Empty State -->
      <div v-else class="text-center py-20">
        <div class="text-6xl mb-4">ğŸ”</div>
        <h2 class="text-2xl font-bold mb-2">è¾“å…¥å…³é”®è¯å¼€å§‹é€‰å“</h2>
        <p class="text-gray-400 max-w-md mx-auto">
          AI å°†è‡ªåŠ¨åˆ†æè¯¥å“ç±»åœ¨ç¾å®¢å¤šçš„ç«äº‰æƒ…å†µï¼Œå¹¶ç»™å‡ºé€‰å“å»ºè®®å’Œè“æµ·æœºä¼š
        </p>
      </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-800 mt-12">
      <div class="max-w-6xl mx-auto px-4 py-6 text-center text-gray-500 text-sm">
        <p>Â© 2025 ç¾å®¢å¤šAIé€‰å“åŠ©æ‰‹ | Powered by 8ai.chat</p>
      </div>
    </footer>

    <!-- Toast -->
    <div
      v-if="toast.show"
      class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-xl shadow-lg flex items-center gap-2"
    >
      <span>{{ toast.icon }}</span>
      <span>{{ toast.message }}</span>
    </div>
  </div>

  <script>
    const { createApp, ref, computed } = Vue;

    createApp({
      setup() {
        // State
        const keyword = ref('');
        const site = ref('MLM');
        const loading = ref(false);
        const result = ref(null);
        const freeQuota = ref(3);
        const toast = ref({ show: false, message: '', icon: '' });

        // Hot tags
        const hotTags = ['phone case', 'bluetooth earbuds', 'led lights', 'yoga mat', 'car accessories'];

        // API Base URL
        const API_BASE = 'https://api.8ai.chat';

        // Computed
        const recommendColor = computed(() => {
          if (!result.value) return '';
          const rec = result.value.analysis.recommendation;
          if (rec === 'æ¨è') return 'text-green-400';
          if (rec === 'é¿å¼€') return 'text-red-400';
          return 'text-yellow-400';
        });

        const scoreColor = computed(() => {
          if (!result.value) return '';
          const score = result.value.analysis.competition_score;
          if (score <= 3) return 'text-green-400';
          if (score <= 6) return 'text-yellow-400';
          return 'text-red-400';
        });

        const scoreBarColor = computed(() => {
          if (!result.value) return '';
          const score = result.value.analysis.competition_score;
          if (score <= 3) return 'bg-green-500';
          if (score <= 6) return 'bg-yellow-500';
          return 'bg-red-500';
        });

        // Methods
        const formatNumber = (num) => {
          if (num >= 10000) return (num / 10000).toFixed(1) + 'ä¸‡';
          if (num >= 1000) return (num / 1000).toFixed(1) + 'k';
          return num;
        };

        const showToast = (message, icon = 'âœ“') => {
          toast.value = { show: true, message, icon };
          setTimeout(() => {
            toast.value.show = false;
          }, 3000);
        };

        const analyze = async () => {
          if (!keyword.value.trim() || loading.value) return;

          if (freeQuota.value <= 0) {
            showToast('å…è´¹æ¬¡æ•°å·²ç”¨å®Œï¼Œè¯·å‡çº§VIP', 'âš ï¸');
            return;
          }

          loading.value = true;
          result.value = null;

          try {
            const response = await fetch(`${API_BASE}/pick/analyze`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                keyword: keyword.value.trim(),
                site: site.value
              })
            });

            if (!response.ok) throw new Error('API error');

            result.value = await response.json();
            freeQuota.value--;
            showToast('åˆ†æå®Œæˆï¼', 'âœ…');
          } catch (error) {
            console.error('Analyze error:', error);
            // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ç”¨äºæ¼”ç¤º
            result.value = getMockResult();
            showToast('ä½¿ç”¨æ¼”ç¤ºæ•°æ®ï¼ˆAPIè¿æ¥ä¸­ï¼‰', 'â„¹ï¸');
          } finally {
            loading.value = false;
          }
        };

        const getMockResult = () => ({
          keyword: keyword.value,
          site: site.value,
          market: {
            total_results: Math.floor(Math.random() * 50000) + 5000,
            price_min: Math.floor(Math.random() * 30) + 10,
            price_max: Math.floor(Math.random() * 300) + 100,
            price_median: Math.floor(Math.random() * 80) + 40,
            price_avg: Math.floor(Math.random() * 70) + 35,
          },
          analysis: {
            competition_score: Math.floor(Math.random() * 10) + 1,
            competition_level: ['ä½', 'ä¸­', 'é«˜'][Math.floor(Math.random() * 3)],
            profit_potential: ['é«˜', 'ä¸­', 'ä½'][Math.floor(Math.random() * 3)],
            recommendation: ['æ¨è', 'è§‚æœ›', 'é¿å¼€'][Math.floor(Math.random() * 3)],
            reason: 'è¯¥å“ç±»åœ¨å¢¨è¥¿å“¥å¸‚åœºæœ‰ä¸€å®šéœ€æ±‚ï¼Œä½†éœ€æ³¨æ„å·®å¼‚åŒ–ç«äº‰',
            sub_niches: [
              keyword.value + ' premium',
              keyword.value + ' mini',
              keyword.value + ' for kids',
            ],
            differentiation_tips: [
              'å¯è€ƒè™‘å¢åŠ æœ¬åœ°åŒ–åŒ…è£…è®¾è®¡',
              'æä¾›è¥¿ç­ç‰™è¯­è¯´æ˜ä¹¦å’Œå®¢æœ',
              'é€‰æ‹©è½»ä¾¿æ¬¾é™ä½ç‰©æµæˆæœ¬',
            ],
          },
          timestamp: new Date().toISOString(),
        });

        const favorite = () => {
          showToast('å·²æ·»åŠ åˆ°æ”¶è—ï¼', 'â­');
        };

        const exportResult = () => {
          if (!result.value) return;
          const text = JSON.stringify(result.value, null, 2);
          const blob = new Blob([text], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `meli-analysis-${keyword.value}-${Date.now()}.json`;
          a.click();
          URL.revokeObjectURL(url);
          showToast('æŠ¥å‘Šå·²å¯¼å‡ºï¼', 'ğŸ“¥');
        };

        return {
          keyword,
          site,
          loading,
          result,
          freeQuota,
          toast,
          hotTags,
          recommendColor,
          scoreColor,
          scoreBarColor,
          formatNumber,
          analyze,
          favorite,
          exportResult,
        };
      }
    }).mount('#app');
  </script>
</body>
</html>
